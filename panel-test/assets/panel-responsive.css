/**
 * Panel Responsive Overrides - Imporlan
 * Fixes mobile/tablet layout issues for all panel pages
 * Loaded after Tailwind compiled CSS to override where needed
 */

/* ===== GLOBAL MOBILE FIXES ===== */
html, body {
  overflow-x: hidden !important;
  width: 100% !important;
  max-width: 100vw !important;
}

#root {
  width: 100% !important;
  max-width: 100vw !important;
  min-width: 0 !important;
  overflow-x: hidden !important;
}

#root > div {
  max-width: 100vw !important;
  overflow-x: hidden !important;
}

/* ===== LOGIN PAGE ===== */
@media (max-width: 767px) {
  /* Ensure the outer container fills viewport */
  #root > div {
    padding: 16px !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Make the grid container full width and single column */
  #root > div > div {
    max-width: 100% !important;
    width: 100% !important;
    padding: 0 !important;
    margin: 0 auto !important;
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }

  /* Info panel (left side on desktop) */
  #root > div > div > div:first-child {
    border-radius: 20px !important;
    padding: 24px !important;
  }

  /* Login form card */
  #root > div > div > div:last-child {
    padding: 24px !important;
    border-radius: 20px !important;
  }

  /* Login form buttons row */
  #root > div > div > div:last-child .flex.gap-3 {
    flex-direction: column !important;
  }

  #root > div > div > div:last-child .flex.gap-3 > button {
    width: 100% !important;
  }
}

/* ===== DASHBOARD / LOGGED-IN PAGES ===== */
@media (max-width: 767px) {
  /* Parent flex container: stack sidebar + main vertically */
  .min-h-screen.flex,
  #root > .flex,
  #root > div.flex {
    flex-direction: column !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Sidebar - target ALL possible sidebar containers */
  aside,
  .w-64,
  .w-72,
  .min-w-64,
  .min-h-screen.flex > .w-64,
  .min-h-screen.flex > .bg-slate-900,
  .min-h-screen.flex > .bg-gray-900,
  .min-h-screen.flex > div.w-64,
  #root > .flex > .w-64,
  #root > div.flex > .w-64 {
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    max-height: none !important;
    height: auto !important;
    min-height: auto !important;
    position: relative !important;
    flex-shrink: 0 !important;
  }

  /* Sidebar nav: horizontal compact layout */
  aside nav,
  aside nav ul,
  .w-64 nav,
  .bg-slate-900 nav,
  .bg-gray-900 nav {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: wrap !important;
    flex: none !important;
    gap: 4px !important;
    padding: 4px 8px !important;
  }

  /* Nav buttons/links: auto width for horizontal wrapping */
  aside nav ul li,
  aside nav button,
  aside nav a,
  .w-64 nav > a,
  .w-64 nav > button,
  .bg-slate-900 nav > a,
  .bg-slate-900 nav > button,
  .bg-gray-900 nav > a,
  .bg-gray-900 nav > button {
    flex: none !important;
    width: auto !important;
    padding: 6px 12px !important;
    font-size: 13px !important;
    margin-bottom: 0 !important;
  }

  aside nav ul li button {
    padding: 6px 12px !important;
    font-size: 13px !important;
  }

  aside nav ul li button svg,
  .w-64 nav button svg,
  .w-64 nav a svg {
    width: 16px !important;
    height: 16px !important;
  }

  /* Sidebar header */
  .w-64 > div:first-child,
  .bg-slate-900 > div:first-child {
    padding: 8px 12px !important;
  }

  /* Sidebar footer (user info + logout) compact */
  aside > div:last-child,
  .w-64 > div:last-child,
  .bg-slate-900 > div:last-child,
  .bg-gray-900 > div:last-child {
    padding: 8px 12px !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 8px !important;
    border-top: 1px solid rgba(255,255,255,0.1) !important;
  }

  .w-64 > div:last-child button,
  .bg-slate-900 > div:last-child button {
    width: auto !important;
    padding: 6px 12px !important;
    font-size: 13px !important;
  }

  /* Main content area - MUST fill full width */
  main,
  [role="main"],
  .flex-1.overflow-auto,
  .flex-1.overflow-y-auto,
  .min-h-screen.flex > main,
  #root > .flex > main,
  #root > div.flex > main {
    width: 100% !important;
    max-width: 100vw !important;
    min-width: 0 !important;
    padding: 12px !important;
    overflow-x: hidden !important;
    flex: 1 1 auto !important;
    box-sizing: border-box !important;
  }

  /* All content containers inside main */
  main > div,
  main > div > div {
    max-width: 100% !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
  }

  /* Dashboard cards grid - single column */
  .grid {
    grid-template-columns: 1fr !important;
    max-width: 100% !important;
  }

  .grid.grid-cols-2,
  .grid.grid-cols-3,
  .grid.grid-cols-4 {
    grid-template-columns: 1fr !important;
  }

  /* Flex row containers that should stack on mobile */
  main .flex.gap-4,
  main .flex.gap-6,
  main .flex.gap-8 {
    flex-direction: column !important;
  }

  /* Cards and containers */
  .rounded-3xl, .rounded-2xl, .rounded-xl {
    border-radius: 16px !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Tables */
  table {
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    max-width: 100%;
  }

  /* Prevent horizontal overflow anywhere */
  .overflow-x-auto {
    max-width: 100vw !important;
  }

  /* Space-y containers - ensure they don't overflow */
  .space-y-4, .space-y-6, .space-y-8 {
    max-width: 100% !important;
  }

  /* Page titles */
  main h1 {
    font-size: 22px !important;
    word-break: break-word !important;
  }

  main .p-6, main .p-8 {
    padding: 12px !important;
  }
}

/* ===== TABLET ADJUSTMENTS ===== */
@media (min-width: 768px) and (max-width: 1023px) {
  #root > div > div {
    max-width: 100% !important;
    padding: 0 16px !important;
  }

  .grid.grid-cols-3 {
    grid-template-columns: repeat(2, 1fr) !important;
  }

  .grid.grid-cols-4 {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

/* ===== FLOATING BUTTONS ON MOBILE ===== */
@media (max-width: 767px) {
  /* Chat floating button - ensure it doesn't overlap content */
  .chat-floating-btn,
  #admin-chat-floating-btn {
    bottom: 16px !important;
    right: 16px !important;
    width: 50px !important;
    height: 50px !important;
    z-index: 999 !important;
  }

  /* Support trigger button */
  #imporlan-support-trigger {
    bottom: 74px !important;
    right: 16px !important;
    padding: 12px !important;
    border-radius: 50% !important;
  }

  #imporlan-support-trigger span {
    display: none !important;
  }
}

/* ===== SUPPORT PAGE ENHANCER OVERRIDES ===== */
@media (max-width: 767px) {
  /* 3-column info cards grid → single column */
  .sp-enhanced > div:nth-child(2) {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }

  /* 2-column FAQ + Form grid → single column */
  .sp-enhanced > div:nth-child(3) {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }

  /* Hero banner padding */
  .sp-enhanced > div:first-child {
    padding: 24px 20px 20px !important;
    border-radius: 16px !important;
  }

  .sp-enhanced > div:first-child h1 {
    font-size: 22px !important;
  }

  .sp-enhanced {
    padding: 0 !important;
  }
}

@media (min-width: 768px) and (max-width: 1023px) {
  /* 3-column → 2-column on tablet */
  .sp-enhanced > div:nth-child(2) {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

/* ===== CHAT MODAL (USER) ON MOBILE ===== */
@media (max-width: 767px) {
  .chat-modal-overlay .chat-modal {
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    border-radius: 0 !important;
    margin: 0 !important;
  }

  .chat-modal-body {
    flex-direction: column !important;
  }
}

/* ===== ADMIN CHAT MODAL ON MOBILE ===== */
@media (max-width: 767px) {
  #admin-chat-modal-overlay,
  .admin-chat-modal-overlay {
    align-items: stretch !important;
    padding: 0 !important;
  }

  #admin-chat-modal-overlay .admin-chat-modal-content,
  .admin-chat-modal-overlay .admin-chat-modal-content,
  #chat-modal-content {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    min-width: 0 !important;
    min-height: 0 !important;
    border-radius: 0 !important;
  }

  /* Conversations panel in modal - full width when active */
  .admin-chat-modal-content .admin-chat-conversations-panel,
  #chat-modal-content .admin-chat-conversations-panel {
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100% !important;
  }

  /* Messages panel hidden until conversation selected */
  .admin-chat-modal-content .admin-chat-messages-panel,
  #chat-modal-content .admin-chat-messages-panel {
    width: 100% !important;
    min-width: 0 !important;
  }

  /* Admin modal body - stack panels */
  .admin-chat-modal-body,
  #chat-modal-content .admin-chat-modal-body {
    flex-direction: column !important;
  }

  /* Resize handles hidden on mobile */
  .admin-resize-handle {
    display: none !important;
  }
}

/* ===== CHAT FULL PAGE (ADMIN) ON MOBILE ===== */
@media (max-width: 767px) {
  .imporlan-chat-container {
    flex-direction: column !important;
    height: auto !important;
    min-height: calc(100vh - 80px) !important;
  }

  .chat-conversations-panel {
    width: 100% !important;
    min-width: 0 !important;
    max-height: 40vh !important;
    border-right: none !important;
    border-bottom: 1px solid #e2e8f0 !important;
  }

  .chat-messages-panel {
    width: 100% !important;
    min-height: 50vh !important;
  }

  .chat-details-panel {
    display: none !important;
  }
}

@media (min-width: 768px) and (max-width: 1023px) {
  .chat-details-panel {
    display: none !important;
  }

  .chat-conversations-panel {
    width: 260px !important;
    min-width: 260px !important;
  }
}

/* ===== SUPPORT FORM MODAL ON MOBILE ===== */
@media (max-width: 540px) {
  #imporlan-support-overlay .sf-modal {
    max-width: 100% !important;
    max-height: 100% !important;
    border-radius: 0 !important;
    height: 100% !important;
  }

  #imporlan-support-overlay .sf-body {
    padding: 16px !important;
  }

  #imporlan-support-overlay .sf-row {
    grid-template-columns: 1fr !important;
    gap: 0 !important;
  }

  #imporlan-support-overlay .sf-actions {
    flex-direction: column-reverse !important;
    gap: 8px !important;
  }

  #imporlan-support-overlay .sf-actions .sf-btn {
    width: 100% !important;
    justify-content: center !important;
  }
}

/* ===== IMAGE AND MEDIA RESPONSIVENESS ===== */
@media (max-width: 767px) {
  img {
    max-width: 100%;
    height: auto;
  }

  iframe, video, embed, object {
    max-width: 100%;
  }
}

/* ===== ADMIN PANEL SPECIFIC ===== */
@media (max-width: 767px) {
  header .flex {
    flex-wrap: wrap !important;
    gap: 8px !important;
  }
}

/* ===== SMOOTH TRANSITIONS ===== */
@media (prefers-reduced-motion: no-preference) {
  .chat-conversations-panel,
  .chat-messages-panel,
  .admin-chat-modal-content {
    transition: width 0.3s ease, transform 0.3s ease;
  }
}

/* ===== NEW CONVERSATION MODAL ON MOBILE ===== */
@media (max-width: 540px) {
  .chat-new-modal-content {
    width: 95% !important;
    max-width: 100% !important;
  }
}

/* ===== PRINT STYLES ===== */
@media print {
  .chat-floating-btn,
  #imporlan-support-trigger,
  #admin-chat-floating-btn {
    display: none !important;
  }
}
